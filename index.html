import React, { useEffect, useMemo, useRef, useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { Search, Settings, Users, Fish, Anchor, Captain, Ship, ClipboardList, FileText, Coins, Megaphone, FileCheck2, Boxes, Trophy, Map, Waves, Scale, BookOpen, MessageSquare, Calendar, Sparkles, ListChecks, Mail } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";

// --- Helper: localStorage state hook -------------------------------------------------
function useLocalStorage(key, initial) {
  const [value, setValue] = useState(() => {
    try {
      const raw = localStorage.getItem(key);
      return raw ? JSON.parse(raw) : initial;
    } catch {
      return initial;
    }
  });
  useEffect(() => {
    try {
      localStorage.setItem(key, JSON.stringify(value));
    } catch {}
  }, [key, value]);
  return [value, setValue];
}

// --- Background Fish Canvas ---------------------------------------------------------
function FishBackground() {
  const canvasRef = useRef(null);
  const pointer = useRef({ x: window.innerWidth / 2, y: window.innerHeight / 2 });
  const fishies = useRef([]);
  const bigFish = useRef(null);
  const DPR = typeof window !== "undefined" ? Math.max(1, Math.min(2, window.devicePixelRatio || 1)) : 1;

  useEffect(() => {
    const canvas = canvasRef.current;
    const ctx = canvas.getContext("2d");

    const resize = () => {
      canvas.width = window.innerWidth * DPR;
      canvas.height = window.innerHeight * DPR;
      ctx.scale(DPR, DPR);
    };
    resize();
    window.addEventListener("resize", resize);

    // Create small fish
    const count = 16;
    fishies.current = Array.from({ length: count }).map((_, i) => ({
      x: Math.random() * window.innerWidth,
      y: Math.random() * window.innerHeight,
      vx: (Math.random() - 0.5) * 1.2,
      vy: (Math.random() - 0.5) * 1.2,
      size: 6 + Math.random() * 6,
      hue: 180 + Math.random() * 100,
      turn: 0.05 + Math.random() * 0.05,
      speed: 0.6 + Math.random() * 0.8,
    }));

    // Big boss fish
    bigFish.current = {
      x: window.innerWidth * 0.8,
      y: window.innerHeight * 0.2,
      vx: 0,
      vy: 0,
      size: 30,
      hue: 15,
      turn: 0.035,
      speed: 1.4,
    };

    let raf;
    const loop = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Soft ocean gradient
      const g = ctx.createLinearGradient(0, 0, 0, window.innerHeight);
      g.addColorStop(0, "rgba(0,40,80,0.18)");
      g.addColorStop(1, "rgba(0,100,120,0.10)");
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);

      // Draw & update small fish
      fishies.current.forEach(f => {
        const dx = pointer.current.x - f.x;
        const dy = pointer.current.y - f.y;
        const a = Math.atan2(dy, dx);
        f.vx = f.vx * (1 - f.turn) + Math.cos(a) * f.speed * f.turn * 10;
        f.vy = f.vy * (1 - f.turn) + Math.sin(a) * f.speed * f.turn * 10;
        f.x += f.vx;
        f.y += f.vy;

        // Wrap around edges
        if (f.x < -20) f.x = window.innerWidth + 20;
        if (f.x > window.innerWidth + 20) f.x = -20;
        if (f.y < -20) f.y = window.innerHeight + 20;
        if (f.y > window.innerHeight + 20) f.y = -20;

        // Render fish as little triangles
        const angle = Math.atan2(f.vy, f.vx);
        ctx.save();
        ctx.translate(f.x, f.y);
        ctx.rotate(angle);
        ctx.fillStyle = `hsla(${f.hue},70%,60%,0.9)`;
        ctx.beginPath();
        ctx.moveTo(-f.size * 0.6, -f.size * 0.5);
        ctx.lineTo(-f.size * 0.6, f.size * 0.5);
        ctx.lineTo(f.size, 0);
        ctx.closePath();
        ctx.fill();
        ctx.restore();
      });

      // Big Fish chases the pointer too (slower turning, bigger inertia)
      const B = bigFish.current;
      const bdx = pointer.current.x - B.x;
      const bdy = pointer.current.y - B.y;
      const ba = Math.atan2(bdy, bdx);
      B.vx = B.vx * (1 - B.turn) + Math.cos(ba) * B.speed * 1.2;
      B.vy = B.vy * (1 - B.turn) + Math.sin(ba) * B.speed * 1.2;
      B.x += B.vx;
      B.y += B.vy;

      // Render Big Fish
      ctx.save();
      ctx.translate(B.x, B.y);
      ctx.rotate(ba);
      ctx.fillStyle = `hsla(${B.hue},80%,55%,0.9)`;
      ctx.beginPath();
      // body
      ctx.ellipse(0, 0, B.size * 1.2, B.size * 0.7, 0, 0, Math.PI * 2);
      ctx.fill();
      // tail
      ctx.beginPath();
      ctx.moveTo(-B.size * 1.2, 0);
      ctx.lineTo(-B.size * 1.8, B.size * 0.5);
      ctx.lineTo(-B.size * 1.8, -B.size * 0.5);
      ctx.closePath();
      ctx.fill();
      // eye
      ctx.fillStyle = "#fff";
      ctx.beginPath();
      ctx.arc(B.size * 0.5, -B.size * 0.15, 4, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillStyle = "#222";
      ctx.beginPath();
      ctx.arc(B.size * 0.55, -B.size * 0.15, 2, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();

      raf = requestAnimationFrame(loop);
    };

    // Pointer listeners (mouse + touch)
    const onMove = e => {
      pointer.current.x = e.clientX;
      pointer.current.y = e.clientY;
    };
    const onTouch = e => {
      if (e.touches && e.touches[0]) {
        pointer.current.x = e.touches[0].clientX;
        pointer.current.y = e.touches[0].clientY;
      }
    };
    window.addEventListener("mousemove", onMove);
    window.addEventListener("touchstart", onTouch, { passive: true });
    window.addEventListener("touchmove", onTouch, { passive: true });

    loop();

    return () => {
      cancelAnimationFrame(raf);
      window.removeEventListener("resize", resize);
      window.removeEventListener("mousemove", onMove);
      window.removeEventListener("touchstart", onTouch);
      window.removeEventListener("touchmove", onTouch);
    };
  }, [DPR]);

  // Fun fish cursor (SVG data URL)
  useEffect(() => {
    const fishSVG = encodeURIComponent(
      `<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'>
        <g fill='none' stroke='none'>
          <path d='M4 16 L10 10 L18 12 L24 8 L22 16 L24 24 L18 20 L10 22 Z' fill='#00bcd4' opacity='0.9'/>
          <circle cx='18' cy='13' r='1.8' fill='#fff'/>
          <circle cx='18.5' cy='13' r='0.9' fill='#222'/>
        </g>
      </svg>`
    );
    document.documentElement.style.cursor = `url("data:image/svg+xml,${fishSVG}") 8 8, auto`;
    return () => {
      document.documentElement.style.cursor = "auto";
    };
  }, []);

  return (
    <canvas
      ref={canvasRef}
      className="fixed inset-0 -z-10 pointer-events-none select-none"
      aria-hidden="true"
    />
  );
}

// --- Modal Shell -------------------------------------------------------------------
function Modal({ open, onClose, title, children }) {
  return (
    <AnimatePresence>
      {open && (
        <motion.div
          className="fixed inset-0 z-50 flex items-center justify-center p-4"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          exit={{ opacity: 0 }}
        >
          <div className="absolute inset-0 bg-black/40" onClick={onClose} />
          <motion.div
            className="relative max-h-[90vh] w-full max-w-4xl overflow-hidden rounded-2xl bg-white/90 backdrop-blur-lg shadow-2xl"
            initial={{ y: 30, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            exit={{ y: 20, opacity: 0 }}
          >
            <div className="flex items-center justify-between border-b border-black/5 p-4 md:p-5">
              <h3 className="text-lg md:text-xl font-semibold">{title}</h3>
              <Button variant="ghost" onClick={onClose}>Close</Button>
            </div>
            <div className="p-4 md:p-6 overflow-y-auto">{children}</div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  );
}

// --- Micro‚ÄëApps (lightweight, offline-first via localStorage) ----------------------
function TreasuryApp() {
  const [rows, setRows] = useLocalStorage("plfc_treasury_rows", []);
  const [form, setForm] = useState({ date: "", item: "", amount: "", type: "income" });
  const total = rows.reduce((a, r) => a + (r.type === "income" ? Number(r.amount) : -Number(r.amount)), 0);
  const add = () => {
    if (!form.item || !form.amount) return;
    setRows([...rows, { ...form, id: crypto.randomUUID() }]);
    setForm({ date: "", item: "", amount: "", type: "income" });
  };
  const remove = id => setRows(rows.filter(r => r.id !== id));
  return (
    <div className="space-y-4">
      <div className="grid grid-cols-2 md:grid-cols-6 gap-2">
        <input className="input" placeholder="Date" value={form.date} onChange={e=>setForm({...form,date:e.target.value})} />
        <input className="input col-span-2" placeholder="Item" value={form.item} onChange={e=>setForm({...form,item:e.target.value})} />
        <input className="input" placeholder="Amount" type="number" value={form.amount} onChange={e=>setForm({...form,amount:e.target.value})} />
        <select className="input" value={form.type} onChange={e=>setForm({...form,type:e.target.value})}>
          <option value="income">Income</option>
          <option value="expense">Expense</option>
        </select>
        <Button onClick={add}>Add</Button>
      </div>
      <div className="rounded-xl border border-black/10 overflow-hidden">
        <table className="min-w-full text-sm">
          <thead className="bg-black/5">
            <tr>
              <th className="p-2 text-left">Date</th>
              <th className="p-2 text-left">Item</th>
              <th className="p-2 text-right">Amount</th>
              <th className="p-2">Type</th>
              <th className="p-2">Actions</th>
            </tr>
          </thead>
          <tbody>
            {rows.map(r => (
              <tr key={r.id} className="odd:bg-white even:bg-black/2">
                <td className="p-2">{r.date}</td>
                <td className="p-2">{r.item}</td>
                <td className="p-2 text-right">{Number(r.amount).toFixed(2)}</td>
                <td className="p-2 text-center">{r.type}</td>
                <td className="p-2 text-center"><Button size="sm" variant="secondary" onClick={()=>remove(r.id)}>Del</Button></td>
              </tr>
            ))}
          </tbody>
          <tfoot>
            <tr className="bg-black/5">
              <td className="p-2 font-semibold" colSpan={2}>Balance</td>
              <td className={`p-2 text-right font-semibold ${total>=0?"text-emerald-700":"text-rose-700"}`}>{total.toFixed(2)}</td>
              <td colSpan={2}></td>
            </tr>
          </tfoot>
        </table>
      </div>
      <p className="text-xs text-black/60">Data is stored in your browser only (localStorage). Export to CSV coming soon.</p>
    </div>
  );
}

function MinutesApp() {
  const [text, setText] = useLocalStorage("plfc_minutes_text", "");
  const download = () => {
    const blob = new Blob([text], { type: "text/plain" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `PLFC-Minutes-${new Date().toISOString().slice(0,10)}.txt`;
    a.click();
  };
  return (
    <div className="space-y-3">
      <textarea className="input h-64" placeholder="Type minutes here..." value={text} onChange={e=>setText(e.target.value)} />
      <div className="flex gap-2">
        <Button onClick={download}>Download .txt</Button>
        <Button variant="secondary" onClick={()=>navigator.clipboard.writeText(text)}>Copy</Button>
      </div>
      <p className="text-xs text-black/60">Tip: paste agenda items here before the meeting, then fill decisions and action items live.</p>
    </div>
  );
}

function TasksApp() {
  const [tasks, setTasks] = useLocalStorage("plfc_tasks", []);
  const [title, setTitle] = useState("");
  const add = () => {
    if (!title.trim()) return;
    setTasks([...tasks, { id: crypto.randomUUID(), title, done: false }]);
    setTitle("");
  };
  const toggle = id => setTasks(tasks.map(t => t.id===id?{...t,done:!t.done}:t));
  const remove = id => setTasks(tasks.filter(t=>t.id!==id));
  return (
    <div className="space-y-4">
      <div className="flex gap-2">
        <input className="input flex-1" placeholder="Add a task (e.g. Book Bowls Club)" value={title} onChange={e=>setTitle(e.target.value)} />
        <Button onClick={add}>Add</Button>
      </div>
      <ul className="space-y-2">
        {tasks.map(t => (
          <li key={t.id} className="flex items-center gap-3 rounded-xl border border-black/10 p-2">
            <input type="checkbox" checked={t.done} onChange={()=>toggle(t.id)} />
            <span className={`${t.done?"line-through text-black/50":""} flex-1`}>{t.title}</span>
            <Button size="sm" variant="secondary" onClick={()=>remove(t.id)}>Del</Button>
          </li>
        ))}
      </ul>
    </div>
  );
}

function GrantsApp() {
  const [grants, setGrants] = useLocalStorage("plfc_grants", [
    { id: crypto.randomUUID(), name: "Qld Community Fishing Grants", status: "Idea", due: "", owner: "" },
    { id: crypto.randomUUID(), name: "GCBF (Round 124)", status: "Drafting", due: "2025-07-18", owner: "Richard" },
  ]);
  const [form, setForm] = useState({ name: "", status: "Idea", due: "", owner: "" });
  const add = () => {
    if (!form.name) return;
    setGrants([...grants, { ...form, id: crypto.randomUUID() }]);
    setForm({ name: "", status: "Idea", due: "", owner: "" });
  };
  const statuses = ["Idea","Drafting","Submitted","Awarded","Not Awarded"];
  return (
    <div className="space-y-4">
      <div className="grid grid-cols-2 md:grid-cols-6 gap-2">
        <input className="input col-span-2" placeholder="Grant name" value={form.name} onChange={e=>setForm({...form,name:e.target.value})} />
        <select className="input" value={form.status} onChange={e=>setForm({...form,status:e.target.value})}>
          {statuses.map(s=> <option key={s}>{s}</option>)}
        </select>
        <input className="input" type="date" value={form.due} onChange={e=>setForm({...form,due:e.target.value})} />
        <input className="input" placeholder="Owner" value={form.owner} onChange={e=>setForm({...form,owner:e.target.value})} />
        <Button onClick={add}>Add</Button>
      </div>
      <div className="grid sm:grid-cols-2 gap-3">
        {grants.map(g => (
          <Card key={g.id} className="rounded-2xl shadow-sm">
            <CardHeader className="pb-2">
              <CardTitle className="text-base">{g.name}</CardTitle>
            </CardHeader>
            <CardContent className="text-sm space-y-1">
              <p><span className="font-medium">Status:</span> {g.status}</p>
              <p><span className="font-medium">Due:</span> {g.due || "‚Äî"}</p>
              <p><span className="font-medium">Owner:</span> {g.owner || "‚Äî"}</p>
            </CardContent>
          </Card>
        ))}
      </div>
    </div>
  );
}

function CommsApp() {
  const [msg, setMsg] = useState("Kia ora crew! Next comp on Sat 14 Sep ‚Äì sign-on 6am at Bowls Club. Tight lines! üé£");
  const [list, setList] = useLocalStorage("plfc_comms_list", [
    { id: crypto.randomUUID(), name: "Andy", email: "andy@example.com" },
    { id: crypto.randomUUID(), name: "Sami", email: "sami@example.com" },
  ]);
  const add = () => {
    const name = prompt("Name?");
    const email = prompt("Email?");
    if (!email) return;
    setList([...list, { id: crypto.randomUUID(), name: name || "", email }]);
  };
  const copyEmails = () => {
    navigator.clipboard.writeText(list.map(x=>x.email).join(", "));
  };
  return (
    <div className="space-y-3">
      <textarea className="input h-40" value={msg} onChange={e=>setMsg(e.target.value)} />
      <div className="flex flex-wrap gap-2">
        <Button onClick={()=>navigator.clipboard.writeText(msg)}>Copy Message</Button>
        <Button variant="secondary" onClick={copyEmails}>Copy All Emails</Button>
        <Button variant="outline" onClick={add}>Add Recipient</Button>
      </div>
      <ul className="grid sm:grid-cols-2 gap-2">
        {list.map(p => (
          <li key={p.id} className="rounded-xl border border-black/10 p-2 text-sm">
            <div className="font-medium">{p.name || "(no name)"}</div>
            <div className="text-black/70">{p.email}</div>
          </li>
        ))}
      </ul>
      <p className="text-xs text-black/60">Pro tip: paste the message into Gmail BCC for a quick bulk send. SMS gateway can be wired later.</p>
    </div>
  );
}

// --- Toy micro-widgets to show in hub (examples) -----------------------------------
function CountdownWidget({ dateString }) {
  const target = useMemo(() => new Date(dateString).getTime(), [dateString]);
  const [now, setNow] = useState(Date.now());
  useEffect(() => {
    const i = setInterval(() => setNow(Date.now()), 1000);
    return () => clearInterval(i);
  }, []);
  const delta = Math.max(0, target - now);
  const d = Math.floor(delta / (1000 * 60 * 60 * 24));
  const h = Math.floor((delta / (1000 * 60 * 60)) % 24);
  const m = Math.floor((delta / (1000 * 60)) % 60);
  const s = Math.floor((delta / 1000) % 60);
  return (
    <div className="text-2xl font-bold tabular-nums">{d}d {h}h {m}m {s}s</div>
  );
}

// --- Main Hub ----------------------------------------------------------------------
export default function PLFCSuperHub() {
  const [query, setQuery] = useState("");
  const [modal, setModal] = useState(null); // string key

  const tiles = [
    { key: "leaderboard", label: "Leaderboard", icon: <Trophy/>, tag: "Fun", action: () => alert("Stub: link to /leaderboard") },
    { key: "bite", label: "Bite Times", icon: <Fish/>, tag: "Fun", action: () => alert("Stub: link to /bite-times") },
    { key: "lure", label: "Lure Picker", icon: <Sparkles/>, tag: "Fun", action: () => alert("Stub: link to /lure-picker") },
    { key: "reefmap", label: "Reef Map", icon: <Map/>, tag: "Conservation", action: () => alert("Stub: link to /reef-map") },
    { key: "knots", label: "Knot Tutor", icon: <Anchor/>, tag: "Learn", action: () => alert("Stub: link to /knots") },
    { key: "eco", label: "Eco Tip", icon: <LeafIcon/>, tag: "Conservation", action: () => alert("Stub: link to /eco-tip") },
    { key: "memes", label: "Meme Maker", icon: <MessageSquare/>, tag: "Fun", action: () => alert("Stub: link to /meme") },
    { key: "countdown", label: "Event Countdown", icon: <Calendar/>, tag: "Events", action: () => setModal("countdown") },
  ];

  const committee = [
    { key: "treasury", label: "Treasury", icon: <Coins/>, action: () => setModal("treasury") },
    { key: "minutes", label: "Minutes", icon: <FileText/>, action: () => setModal("minutes") },
    { key: "tasks", label: "Tasks", icon: <ListChecks/>, action: () => setModal("tasks") },
    { key: "grants", label: "Grants", icon: <FileCheck2/>, action: () => setModal("grants") },
    { key: "comms", label: "Comms", icon: <Mail/>, action: () => setModal("comms") },
  ];

  const filteredTiles = tiles.filter(t => t.label.toLowerCase().includes(query.toLowerCase()));

  return (
    <div className="min-h-screen text-slate-900">
      <FishBackground />

      {/* Header */}
      <header className="sticky top-0 z-10 backdrop-blur-md bg-white/50 border-b border-black/5">
        <div className="mx-auto max-w-7xl p-3 md:p-4 flex items-center gap-3">
          <div className="flex items-center gap-2">
            <span className="text-2xl">üêü</span>
            <h1 className="text-xl md:text-2xl font-bold tracking-tight">PLFC Super Hub</h1>
          </div>
          <div className="ml-auto relative w-full max-w-lg">
            <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-black/50" />
            <input
              className="input pl-10"
              placeholder="Search tiles (e.g. Grants, Knot, Reef)"
              value={query}
              onChange={e=>setQuery(e.target.value)}
            />
          </div>
          <Button variant="outline" className="hidden md:inline-flex" onClick={()=>alert("Settings coming soon")}> <Settings className="mr-2 h-4 w-4"/> Settings</Button>
        </div>
      </header>

      {/* Hero */}
      <section className="mx-auto max-w-7xl px-3 md:px-4 py-6 md:py-10">
        <div className="grid md:grid-cols-3 gap-4 items-center">
          <div className="md:col-span-2">
            <h2 className="text-2xl md:text-4xl font-extrabold leading-tight">Welcome to the Point Lookout Fishing Club üé£</h2>
            <p className="mt-2 text-black/70 max-w-2xl">A playful, linkable set of micro‚Äëapps for members and committee. Start with the tiles below, and we‚Äôll stitch them into the full Straddie Super‚ÄëApp later.</p>
            <div className="mt-4 flex flex-wrap gap-2">
              <Button onClick={()=>setModal("countdown")}>Next Event Countdown</Button>
              <Button variant="secondary" onClick={()=>alert("Open docs repo")}>Docs</Button>
              <Button variant="outline" onClick={()=>alert("Open GitHub org")}>GitHub</Button>
            </div>
          </div>
          <Card className="rounded-2xl shadow-sm">
            <CardHeader className="pb-2">
              <CardTitle className="text-base">Quick Glance</CardTitle>
            </CardHeader>
            <CardContent>
              <div className="grid grid-cols-2 gap-3 text-sm">
                <div className="rounded-xl bg-white/70 p-3 shadow-inner">
                  <div className="text-black/60">Next Comp</div>
                  <CountdownWidget dateString={new Date(Date.now()+1000*60*60*24*35).toISOString()} />
                </div>
                <div className="rounded-xl bg-white/70 p-3 shadow-inner">
                  <div className="text-black/60">Balance (demo)</div>
                  <div className="text-2xl font-bold">$ 0.00</div>
                </div>
              </div>
            </CardContent>
          </Card>
        </div>
      </section>

      {/* Tiles */}
      <section className="mx-auto max-w-7xl px-3 md:px-4 pb-10">
        <h3 className="text-lg font-semibold mb-3">Member Toys</h3>
        <div className="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
          {filteredTiles.map(t => (
            <motion.button
              key={t.key}
              onClick={t.action}
              whileHover={{ y: -4 }}
              whileTap={{ scale: 0.98 }}
              className="rounded-2xl bg-white/80 backdrop-blur shadow hover:shadow-lg border border-black/5 p-4 text-left group"
            >
              <div className="flex items-center gap-3">
                <div className="rounded-xl p-2 bg-sky-50 border border-sky-100 text-sky-700">{t.icon}</div>
                <div>
                  <div className="font-semibold tracking-tight">{t.label}</div>
                  <div className="text-xs text-black/60">{t.tag}</div>
                </div>
              </div>
            </motion.button>
          ))}
        </div>

        <h3 className="text-lg font-semibold mt-8 mb-3">Committee Micro‚ÄëApps</h3>
        <div className="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
          {committee.map(c => (
            <motion.button
              key={c.key}
              onClick={c.action}
              whileHover={{ y: -4 }}
              whileTap={{ scale: 0.98 }}
              className="rounded-2xl bg-white/90 backdrop-blur shadow hover:shadow-lg border border-black/5 p-4 text-left"
            >
              <div className="flex items-center gap-3">
                <div className="rounded-xl p-2 bg-emerald-50 border border-emerald-100 text-emerald-700">{c.icon}</div>
                <div className="font-semibold tracking-tight">{c.label}</div>
              </div>
              <div className="mt-2 text-xs text-black/60">Local‚Äëonly data, export‚Äëready.</div>
            </motion.button>
          ))}
        </div>
      </section>

      {/* Footer */}
      <footer className="border-t border-black/5 bg-white/60 backdrop-blur">
        <div className="mx-auto max-w-7xl p-4 text-xs text-black/60 flex flex-wrap items-center gap-3">
          <span>¬© {new Date().getFullYear()} Point Lookout Fishing Club</span>
          <span className="hidden sm:inline">‚Ä¢</span>
          <a className="underline underline-offset-4" href="#" onClick={(e)=>{e.preventDefault(); alert('Open Constitution')}}>Constitution</a>
          <span className="hidden sm:inline">‚Ä¢</span>
          <a className="underline underline-offset-4" href="#" onClick={(e)=>{e.preventDefault(); alert('Open Minutes')}}>Minutes</a>
          <span className="ml-auto">Made with üíô on Straddie</span>
        </div>
      </footer>

      {/* Modals */}
      <Modal open={modal==="treasury"} onClose={()=>setModal(null)} title="Treasury ‚Äì Simple Ledger">
        <TreasuryApp />
      </Modal>
      <Modal open={modal==="minutes"} onClose={()=>setModal(null)} title="Minutes ‚Äì Quick Capture">
        <MinutesApp />
      </Modal>
      <Modal open={modal==="tasks"} onClose={()=>setModal(null)} title="Tasks ‚Äì To‚ÄëDo Tracker">
        <TasksApp />
      </Modal>
      <Modal open={modal==="grants"} onClose={()=>setModal(null)} title="Grants ‚Äì Pipeline Overview">
        <GrantsApp />
      </Modal>
      <Modal open={modal==="comms"} onClose={()=>setModal(null)} title="Comms ‚Äì Message Prep & Recipients">
        <CommsApp />
      </Modal>
      <Modal open={modal==="countdown"} onClose={()=>setModal(null)} title="Event Countdown">
        <div className="flex items-center gap-6">
          <CountdownWidget dateString={new Date(Date.now()+1000*60*60*24*35).toISOString()} />
          <div className="text-sm text-black/70">Set your event date directly in code or wire to a config JSON later.</div>
        </div>
      </Modal>

      {/* Tiny utility styles */}
      <style>{`
        .input { @apply w-full rounded-xl border border-black/10 bg-white/80 backdrop-blur px-3 py-2 outline-none focus:ring-2 focus:ring-sky-300; }
      `}</style>
    </div>
  );
}

// Simple Leaf icon fallback (since we didn't import from lucide)
function LeafIcon(props){
  return (
    <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
      <path d="M11 3C7 3 3 7 3 11c0 4 3 7 7 7 7 0 11-8 11-15 0 0-8 0-10 0"/>
    </svg>
  );
}
